<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JARVIS NEURAL INTERFACE 2066 - DASHBOARD</title>
    <link rel="icon" href="/static/favicon.ico">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&display=swap"
          rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&display=swap"
          rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'cyber-blue': '#00e5ff',
                        'cyber-blue-dark': '#00b8d4',
                        'cyber-secondary': '#2979ff',
                        'cyber-accent': '#00fff0',
                        'cyber-dark': '#0a0e17',
                        'cyber-darker': '#060a12',
                        'cyber-text': '#e0f7fa',
                        'cyber-text-dim': '#b3e5fc',
                        'cyber-success': '#00e676',
                        'cyber-warning': '#ffab00',
                        'cyber-error': '#ff5252'
                    },
                    fontFamily: {
                        'rajdhani': ['Rajdhani', 'sans-serif'],
                        'orbitron': ['Orbitron', 'monospace']
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': {transform: 'translateY(0)'},
                            '50%': {transform: 'translateY(-10px)'},
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .glow-border {
            box-shadow: 0 0 0 1px rgba(0, 229, 255, 0.3),
            0 0 40px rgba(0, 229, 255, 0.1),
            inset 0 0 40px rgba(0, 229, 255, 0.05);
        }

        .text-glow {
            text-shadow: 0 0 10px rgba(0, 229, 255, 0.5);
        }

        /* Grid overlay */
        .grid-overlay {
            position: absolute;
            inset: 0;
            background-image: linear-gradient(rgba(0, 229, 255, 0.05) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0, 229, 255, 0.05) 1px, transparent 1px);
            background-size: 30px 30px;
            z-index: 5;
            pointer-events: none;
        }

        /* Hexagon pattern */
        .hexagon-bg {
            position: absolute;
            inset: 0;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg id='hexagons' fill='%2300e5ff' fill-opacity='0.03' fill-rule='nonzero'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9zM0 15l12.98-7.5V0h-2v6.35L0 12.69v2.3zm0 18.5L12.98 41v8h-2v-6.85L0 35.81v-2.3zM15 0v7.5L27.99 15H28v-2.31h-.01L17 6.35V0h-2zm0 49v-8l12.99-7.5H28v2.31h-.01L17 42.15V49h-2z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.3;
            z-index: 1;
            pointer-events: none;
        }

        /* Status indicators */
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            font-size: 0.65rem;
            color: rgba(224, 247, 250, 0.7);
            letter-spacing: 0.05em;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-online {
            background-color: #00e676;
        }

        .status-processing {
            background-color: #ffab00;
        }

        .status-ready {
            background-color: #00e5ff;
        }

        /* User name styling */
        .user-name {
            background: linear-gradient(45deg, #00e5ff, #2979ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        /* Widget container - MAIN FOCUS */
        .widget-main-container {
            position: relative;
            background: rgba(10, 14, 23, 0.4);
            border: 1px solid rgba(0, 229, 255, 0.2);
            border-radius: 12px;
            padding: 1rem;
            backdrop-filter: blur(5px);
            box-shadow: 0 0 0 1px rgba(0, 229, 255, 0.2),
            0 0 30px rgba(0, 229, 255, 0.05);
            min-height: 70vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* ConvAI widget styling - KEEP WIDGET VISIBLE */
        elevenlabs-convai {
            width: 100% !important;
            max-width: 100% !important;
            height: auto !important;
            margin: 0 auto;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        /* Compact header */
        .compact-header {
            position: absolute;
            top: 1rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            text-align: center;
        }

        /* Welcome message - minimal */
        .welcome-minimal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 100;
            text-align: right;
            font-size: 0.75rem;
        }

        /* Custom overlay to hide branding - SURGICAL APPROACH */
        .branding-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: rgba(10, 14, 23, 0.95);
            z-index: 1000;
            pointer-events: none;
            border-radius: 12px 12px 0 0;
        }
    </style>
</head>
<body class="bg-cyber-darker text-cyber-text font-rajdhani h-screen w-screen relative overflow-hidden">

<!-- Three.js Background -->
<div id="canvas-container" class="fixed inset-0 z-0"></div>

<!-- Grid and Hexagon Overlays -->
<div class="grid-overlay fixed inset-0 z-1"></div>
<div class="hexagon-bg fixed inset-0 z-1"></div>

<!-- Compact Header -->
<div class="compact-header">
    <h1 class="font-orbitron text-2xl font-bold tracking-[4px] text-cyber-blue text-glow">J.A.R.V.I.S</h1>
    <div class="flex justify-center space-x-4 mt-1">
        <div class="status-indicator">
            <div class="status-dot status-online"></div>
            <span>ONLINE</span>
        </div>
        <div class="status-indicator">
            <div class="status-dot status-ready"></div>
            <span>AI READY</span>
        </div>
        <div class="status-indicator">
            <div class="status-dot status-processing"></div>
            <span>ACTIVE</span>
        </div>
    </div>
</div>

<!-- Welcome Message - Minimal -->
<div class="welcome-minimal">
    <div class="text-cyber-success text-xs mb-1">âœ“ AUTHENTICATED</div>
    <div class="text-cyber-text-dim text-xs">
        <span class="user-name">{{ user_name }}</span>
    </div>
</div>
<!-- Automation Button -->
<div class="fixed bottom-6 right-6" style="z-index:9999;">
    <a href="{{ url_for('automation') }}?username={{ user_name }}"
       class="bg-gradient-to-r from-cyber-blue to-cyber-secondary text-cyber-text px-6 py-3 rounded-xl text-base font-bold shadow-lg hover:opacity-90 transition">
        ðŸš€ Automation
    </a>
</div>


<!-- Main Widget Container - FULL FOCUS -->
<div class="relative z-50 h-screen w-screen flex items-center justify-center p-6">
    <div class="widget-main-container w-full max-w-6xl">

        <!-- Branding Overlay - covers only the top branding area -->
        <div class="branding-overlay"></div>

        <!-- ConvAI Widget - THE STAR OF THE SHOW -->
        <div class="flex-1 flex items-center justify-center">
            <elevenlabs-convai agent-id="agent_2701k56q1vtnf9pvn7h2a201qwfa"></elevenlabs-convai>
        </div>

    </div>
</div>

<!-- Minimal Footer -->
<div class="absolute bottom-2 left-1/2 transform -translate-x-1/2 text-xs text-cyber-text-dim/30 tracking-wider z-50">
    STARK INDUSTRIES â€¢ NEURAL INTERFACE v2066.3.15
</div>

<!-- ElevenLabs ConvAI Script -->
<script src="https://unpkg.com/@elevenlabs/convai-widget-embed" async type="text/javascript"></script>

<script>
    // Background animation (lighter version)
    function initThreeJsBackground() {
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 50;
        const renderer = new THREE.WebGLRenderer({antialias: true, alpha: true});
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x060a12, 1);
        container.appendChild(renderer.domElement);

        // Create fewer particles for less distraction
        const particlesGeometry = new THREE.BufferGeometry();
        const particlesCount = 800;
        const posArray = new Float32Array(particlesCount * 3);
        for (let i = 0; i < particlesCount * 3; i++) {
            posArray[i] = (Math.random() - 0.5) * 120;
        }
        particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));

        // Subtler particles
        const particlesMaterial = new THREE.PointsMaterial({
            size: 0.15,
            color: 0x00e5ff,
            transparent: true,
            opacity: 0.4,
            blending: THREE.AdditiveBlending
        });

        const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
        scene.add(particlesMesh);

        // Subtle glow effect
        const glowGeometry = new THREE.SphereGeometry(40, 32, 32);
        const glowMaterial = new THREE.MeshBasicMaterial({
            color: 0x00b8d4,
            transparent: true,
            opacity: 0.02,
            side: THREE.BackSide
        });
        const glowMesh = new THREE.Mesh(glowGeometry, glowMaterial);
        scene.add(glowMesh);

        // Minimal mouse interaction
        let mouseX = 0;
        let mouseY = 0;
        document.addEventListener('mousemove', (event) => {
            mouseX = (event.clientX / window.innerWidth) * 2 - 1;
            mouseY = -(event.clientY / window.innerHeight) * 2 + 1;
        });

        function animate() {
            requestAnimationFrame(animate);

            // Slower, subtler rotation
            particlesMesh.rotation.x += 0.0001;
            particlesMesh.rotation.y += 0.0002;
            particlesMesh.rotation.x += mouseY * 0.00005;
            particlesMesh.rotation.y += mouseX * 0.00005;

            // Subtle pulse
            const time = Date.now() * 0.0005;
            glowMesh.material.opacity = 0.01 + Math.sin(time) * 0.01;

            renderer.render(scene, camera);
        }

        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    }

    // GENTLE branding removal - only target specific text, keep widget functional
    function hideBrandingText() {
        setTimeout(() => {
            const widget = document.querySelector('elevenlabs-convai');
            if (widget) {
                // Look for text nodes containing branding
                const walker = document.createTreeWalker(
                        widget,
                        NodeFilter.SHOW_TEXT,
                        null,
                        false
                );

                let textNode;
                const nodesToHide = [];

                while (textNode = walker.nextNode()) {
                    const text = textNode.textContent.toLowerCase();
                    if (text.includes('powered by') ||
                            text.includes('elevenlabs') ||
                            (text.includes('conversational') && text.includes('ai'))) {
                        // Find the parent element to hide
                        let parent = textNode.parentElement;
                        while (parent && parent !== widget) {
                            if (parent.tagName && parent.offsetHeight < 50) { // Only hide small header elements
                                nodesToHide.push(parent);
                                break;
                            }
                            parent = parent.parentElement;
                        }
                    }
                }

                // Hide only the branding elements, not the whole widget
                nodesToHide.forEach(node => {
                    if (node && node.offsetHeight < 100) { // Safety check - don't hide large elements
                        node.style.opacity = '0';
                        node.style.height = '0';
                        node.style.overflow = 'hidden';
                        node.style.margin = '0';
                        node.style.padding = '0';
                    }
                });
            }

            // Run again after a delay to catch dynamic content
            setTimeout(hideBrandingText, 3000);
        }, 2000);
    }

    // Initialize everything when DOM is loaded
    document.addEventListener('DOMContentLoaded', function () {
        console.log("JARVIS Dashboard - Widget-Focused Mode (Gentle Branding Removal)");
        initThreeJsBackground();
        hideBrandingText();

        // Minimal startup effect
        setTimeout(() => {
            console.log("ConvAI widget ready - branding gently hidden");
        }, 1000);
    });

    // Also run when widget loads
    window.addEventListener('load', () => {
        setTimeout(hideBrandingText, 1000);
    });
</script>
</body>
</html>